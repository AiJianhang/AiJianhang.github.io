/*! bibtex-js - v1.0.0 - 2013-12-11
* https://github.com/pcooksey/bibtex-js
* Copyright (c) 2013 Pete Cooksey; Licensed MIT */
var BibtexParser=function(){function e(e,t){return t>e?1:e>t?-1:0}function t(e){return e.replace(/\\\"/g,'"').replace(/\\\{/g,"{").replace(/\\\}/g,"}")}var n=function(){this.entries={}};return n.prototype.setInput=function(e){this.input=e},n.prototype.getEntries=function(){return this.entries},n.prototype.isWhitespace=function(e){return" "==e||"\r"==e||"\t"==e||"\n"==e},n.prototype.match=function(e){return this.input.toLowerCase().startsWith(e.toLowerCase())},n.prototype.consume=function(e){this.input=this.input.substring(e.length)},n.prototype.whitespace=function(){for(;this.input.length>0&&this.isWhitespace(this.input[0]);)this.consume(this.input[0])},n.prototype.expect=function(e){this.whitespace(),this.match(e)?this.consume(e):console.log("Expected '"+e+"' but got '"+this.input.substring(0,10)+"...'")},n.prototype.parseEntry=function(){var e,t,n,r,o,i,s={};for(this.expect("@"),this.input=this.input.substring(1),t=this.input.search(/[\{\(]/),e=this.input.substring(0,t),this.input=this.input.substring(t),this.expect("{"),n=this.input.indexOf(","),r=this.input.substring(0,n),this.input=this.input.substring(n+1),this.whitespace();this.input.length>0&&"}"!=this.input[0];){for(o=this.input.search("="),i=this.input.substring(0,o).replace(/^\s+|\s+$/g,""),this.input=this.input.substring(o+1),this.whitespace(),"{"==this.input[0]?(this.expect("{"),o=this.input.indexOf("}"),s[i]=t(this.input.substring(0,o)),this.input=this.input.substring(o+1)):'"'==this.input[0]?(this.expect('"'),o=this.input.indexOf('"'),s[i]=t(this.input.substring(0,o)),this.input=this.input.substring(o+1)):(o=this.input.search(/,|\}/),s[i]=t(this.input.substring(0,o)),this.input=this.input.substring(o)),this.whitespace(),","==this.input[0]&&this.input.length>0&&(this.expect(","),this.whitespace());}this.expect("}"),s.KEY=r,this.entries[r]={type:e.toLowerCase(),entryTags:s}},n.prototype.toHTML=function(e){var t="",n=[],r="";for(var o in this.entries)n.push(o);return n.sort(e),n.forEach((function(e){var n=this.entries[e].entryTags;t+='<div class="bibtexentry">',t+='<span class="bibtexauthor">'+n.AUTHOR+"</span>, ",t+='<span class="bibtextitle">"'+n.TITLE+'"</span>, ',n.JOURNAL&&(t+="<em>"+n.JOURNAL+"</em>, "),n.YEAR&&(t+=n.YEAR+", "),n.NOTE&&(t+=n.NOTE+", "),t+=".</div>"}),this),t},n}(),BibtexDisplay=function(){function t(e,n){this.bibfilename=e,this.target=n,this.entries=[],this.load()}return t.prototype.load=function(){var t=this,n=new XMLHttpRequest;n.open("GET",this.bibfilename,!0),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?(t.parse(n.responseText),t.display()):console.error("Could not load bib file: "+n.status))},n.send()},t.prototype.parse=function(e){var t=new BibtexParser;t.setInput(e),t.parse(),this.entries=t.getEntries()},t.prototype.display=function(){var e=document.getElementById(this.target);e.innerHTML="";for(var t in this.entries){var n=this.entries[t],r=document.createElement("div");r.className="bibtexentry";var o=document.createElement("span");o.className="bibtexauthor",o.textContent=n.entryTags.AUTHOR||"",r.appendChild(o);var i=document.createElement("span");i.className="bibtextitle",i.textContent=' "'+(n.entryTags.TITLE||"")+'"',r.appendChild(i);var s=document.createElement("span");s.className="bibtexjournal",s.innerHTML=n.entryTags.JOURNAL?" <em>"+n.entryTags.JOURNAL+"</em>":"",r.appendChild(s);var a=document.createElement("span");a.className="bibtexyear",a.innerHTML=n.entryTags.YEAR?" "+n.entryTags.YEAR:"",r.appendChild(a),e.appendChild(r)}},t}();function bibtexify(e,t){new BibtexDisplay(e,t)}

